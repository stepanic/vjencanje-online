{"version":3,"sources":["scripts/app-a18d98ca19.js"],"names":["angular","module","constant","backendUrl","enableLogging","WallVerifiedController","$scope","$rootScope","$state","$timeout","$interval","$log","$sce","$sails","WallService","$window","localStorageService","setNewMedia","data","isRandomAllowed","vm","isActiveMainImage","file","url","type","orientation","trustedUrl","trustAsResourceUrl","controls","$apply","files","unshift","mainFile","slice","updateUI","showRandomMedia","first","shift","push","windowInnerHeight","innerHeight","windowInnerWidth","innerWidth","firstImageWidth","this","updateCachedMedia","updatedCachedMedia","set","cachedMedia","get","flags","enableMainFileAnimation","wallMode","slideshow","length","copy","wall","current","go","id","password","image","roomName","crosstab","on","message","info","supported","isConnected","post","then","resp","error","approvedFile","w","element","bind","changeMainFile","key","old","ToggleWallMode","GoToRecord","isVisibleWallVerifyOption","GoToWallVerify","href","absolute","open","removeFile","console","log","index","indexOf","jQuery","trigger","which","splice","indexInCache","i","handleFile","event","$inject","controller","WallController","$stateParams","cfpLoadingBar","ExifService","getOrientation","name","checked","verifyFile","wallPassword","wallMasterKey","masterKey","isVerifyPage","$on","removeAllListeners","thisChangedTimeout","cancel","forEach","existingFile","disapprovedFile","unverifyFile","broadcast","e","approveFile","disapproveFile","directive","priority","link","scope","attr","$observe","value","muted","imageUrl","callback","xhr","XMLHttpRequest","responseType","onload","arrayBuffer","Uint8Array","response","exifData","EXIF","readFromBinaryFile","buffer","parseInt","Orientation","send","service","RecordController","$mdDialog","UploadService","deviceDetector","validator","eachSeries","$q","applyProgress","progressCounter","download","os","reader","FileReader","errorHandler","msg","code","FileError","QUOTA_EXCEEDED_ERR","NOT_FOUND_ERR","SECURITY_ERR","INVALID_MODIFICATION_ERR","INVALID_STATE_ERR","onInitFs","fs","f","root","getFile","create","exclusive","fileEntry","createWriter","fileWriter","write","target","result","startsWith","filename","document","createElement","setAttribute","window","webkitStorageInfo","requestQuota","PERSISTENT","grantedBytes","requestFileSystem","body","removeChild","readAsDataURL","location","showProgressBar","HandleFiles","asyncFilesUploadHandler","deferred","defer","separatedFiles","currentFileIndex","resolve","offset","progress","loaded","total","absoluteProgress","promise","start","filesInArray","setTimeout","complete","goToProfile","EditProfile","GoToWall","GoToHomepage","confirm","GoToGallery","googleDriveFolderId","prefix","$parse","restrict","attrs","model","fileModel","modelSetter","assign","ProfileController","email","displayName","saveProfileAndReturnToRecord","isValidEmail","invalidEmail","InfoController","HomeController","passwordIsFocused","pin","pinIsFocused","failedPinTry","SetValidPin","wrongPin","auth","wrongPassword","toLowerCase","hasPin","activeTab","OpenTab","tabId","$watch","focusMe","val","isDefined","focus","EMAIL_REGEXP","test","stringHelpers","transliterateCyrillicToLatin","word","answer","a","hasOwnProperty","undefined","replaceDiacritics","str","defaultDiacriticsRemovalMap","base","letters","replace","replaceSpacesWithUnderscores","keepOnlyAlfanumericsDotsMonkeysUnderscoresAndDashes","unicodeToAscii","toSafeUriString","input","part","out","urlParts","split","filenameParts","match","filter","ENV","$http","requestUrl","serverBase","fd","FormData","append","transformRequest","identity","headers","Content-Type","success","approveFileApi","disapprove","params","status","summary","getFilePrefix","currentEmail","currentDisplayName","uploadFiles","uploadProgress","uploadUrl","upload","addEventListener","readyState","JSON","parse","runBlock","pathname","debug","run","routerConfig","$stateProvider","$urlRouterProvider","state","templateUrl","controllerAs","otherwise","config","$logProvider","$locationProvider","localStorageServiceProvider","cfpLoadingBarProvider","debugEnabled","html5Mode","hashPrefix","setPrefix","autoIncrement","$sailsProvider","logExProvider","$templateCache","put"],"mappings":"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","file":"scripts/app-a18d98ca19.js","sourcesContent":["angular.module(\"mediaWall.env\", [])\n\n.constant(\"ENV\", {\n \"backendUrl\": \"http://api.vjencanje.online:80\",\n \"enableLogging\": true\n})\n\n;\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall', [\n        'mediaWall.env',\n        'mediaWall.helpers',\n        'ngAnimate',\n        'ngCookies',\n        'ngTouch',\n        'ngSanitize',\n        'ngMessages',\n        'ngAria',\n        'ui.router',\n        'ngMaterial',\n        'angular-loading-bar',\n        'LocalStorageModule',\n        'ngSails',\n        'log.ex.uo',\n        'ng.deviceDetector',\n        'com.2fdevs.videogular',\n        // 'com.2fdevs.videogular.plugins.controls',\n        // 'com.2fdevs.videogular.plugins.overlayplay',\n        // 'com.2fdevs.videogular.plugins.poster',\n        'rt.asyncseries',\n        'cp.ng.fix-image-orientation'\n      ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .controller('WallVerifiedController', WallVerifiedController);\n\n  /** @ngInject */\n  function WallVerifiedController($scope, $rootScope, $state, $timeout, $interval, $log, $sce, $sails, WallService, $window, localStorageService) {\n    var vm = this;\n\n    var updateCachedMedia = function (updatedCachedMedia) {\n      localStorageService.set('cachedMedia', updatedCachedMedia);\n    }\n    var cachedMedia = localStorageService.get('cachedMedia');\n    if (!cachedMedia) {\n      cachedMedia = [];\n      updateCachedMedia(cachedMedia);\n    }\n\n    // UI flags for show/hide\n    vm.flags = {};\n    vm.flags.enableMainFileAnimation = true;\n\n    vm.wallMode = 'verified';\n\n    vm.slideshow = true;\n\n    vm.files = [];\n    if (cachedMedia.length) {\n      vm.files = angular.copy(cachedMedia);\n    }\n    vm.mainFile = null;\n\n    // Current authenticated wall\n    var wall = WallService.current();\n\n    if (!wall) {\n      $state.go('home');\n    }\n\n    var wallPassword = wall.password;\n\n    var id = null;\n    if (wall && wall.id) {\n      id = wall.id;\n    }\n\n    if (!id) {\n      return;\n    }\n\n    if (wall.image) {\n      vm.image = wall.image;\n    }\n\n    var roomName = 'wall' + id;\n\n\n    function setNewMedia(data) {\n      isRandomAllowed = false;\n\n      vm.isActiveMainImage = true;\n\n      // New image is shown for minimal 15 seconds\n      $timeout(function() {\n        isRandomAllowed = true;\n      }, 25000);\n\n      var file = {\n        url: data.url,\n        type: data.type,\n        orientation: data.orientation,\n        trustedUrl: $sce.trustAsResourceUrl(data.url),\n        controls: data.controls\n      };\n\n      $timeout(function () {\n        $scope.$apply(function () {\n          vm.files.unshift(file);\n          vm.mainFile = file;\n\n          // Main photo + 24 at mosaic\n          vm.files = vm.files.slice(0, 25);\n\n          // Update UI on new data\n          updateUI();\n\n\n          $timeout(function() {\n            vm.isActiveMainImage = false;\n          }, 18000);\n\n          if (vm.files[0]) {\n            vm.files[0].controls = false;\n          }\n        });\n      });\n    }\n\n    // Crosstab suff --------------------------\n    //\n    // Listen for changes and update $scope\n    crosstab.on('wallNewMedia', function(message) {\n      $log.info(\"crosstab\", message);\n\n      setNewMedia(message.data);\n    });\n    // END - Crosstab suff --------------------------\n\n    $log.info('is crosstab supported', crosstab.supported);\n\n    // Crosstab fallback Sockets\n    if (!crosstab.supported) {\n      var isConnected = false;\n      // Subscribe to Sails server for listen for changes\n      $sails.on(\"connect\", function () {\n        $log.info('Connected to Sails sockets');\n        $sails.post(\"/notify/subscribe\", { roomName: roomName })\n          .then(function (resp) {\n            $log.info('Subscribe OK', resp)\n            isConnected = true;\n          }, function (resp) {\n            $log.error('Subscribe NOT OK', resp)\n          });\n      });\n\n      // TODO(stepanic): refactor this code and remove redundant code\n      $timeout(function () {\n        if (!isConnected) {\n          $log.info('Not connected, try again!');\n          $sails.post(\"/notify/subscribe\", { roomName: roomName })\n            .then(function (resp) {\n              $log.info('Subscribe OK when connected', resp)\n              isConnected = true;\n            }, function (resp) {\n              $log.error('Subscribe NOT OK when connected', resp)\n            });\n        }\n      }, 2000);\n\n      // Watching for updates\n      $sails.on(\"notify-remote-approve\", function (approvedFile) {\n        $log.info('notify-remote-approve', approvedFile);\n\n        setNewMedia(approvedFile);\n      });\n    }\n    // END - Sails.js SOCKET suff --------------------------\n\n    var isRandomAllowed = false;\n    function showRandomMedia() {\n      if (isRandomAllowed) {\n        // var key = Math.round(Math.random() * (vm.files.length - 1));\n        // console.log('randomKey', key);\n        // vm.changeMainFile(key);\n\n        // REFACTORED(stepanic): use queue instead of random\n        // to more change sidebar\n        var first = vm.files[0];\n        vm.files.shift();\n        // Add to end of array\n        if (first) {\n          vm.files.push(first);\n        }\n      }\n    }\n\n    // Random Media every 15 seconds\n    $interval(showRandomMedia, 15000);\n\n    function updateUI() {\n      $scope.windowInnerHeight = $window.innerHeight;\n      $scope.windowInnerWidth = $window.innerWidth;\n      $scope.firstImageWidth = $scope.windowInnerWidth;\n\n      $timeout(function () {\n        // Return to 80% of window width after 15 seconds\n        $scope.firstImageWidth = $scope.windowInnerWidth * 0.8;\n      }, 1500);\n    }\n\n    // Update on load\n    updateUI();\n\n    // updateUI on window resize\n    var w = angular.element($window);\n    w.bind('resize', function () {\n      $scope.$apply(function () {\n        updateUI();\n      });\n    });\n\n    vm.changeMainFile = function (key) {\n      var old = vm.files[0];\n      if (old) {\n        old.controls = false;\n      }\n      vm.files[0] = vm.files[key];\n      if (vm.files[0]) {\n        vm.files[0].controls = true;\n      }\n      if (old) {\n        vm.files[key] = old;\n      }\n      // console.log(old, vm.files, vm.files[key]);\n    }\n\n    // window.bla = vm.files;\n    // window.bla2 = vm.changeMainFile;\n\n    vm.ToggleWallMode = function() {\n      // $state.go('wallDirect', { wallPassword: wallPassword });\n      $state.go('wall');\n    }\n\n    vm.GoToRecord = function() {\n      $state.go('record');\n    }\n\n    vm.isVisibleWallVerifyOption = true;\n    vm.GoToWallVerify = function() {\n      var url = $state.href('wallVerify', {}, {absolute:true});\n      $window.open(url, '_blank');\n    }\n\n\n    /**\n     * Remove media from UI\n     */\n    vm.removeFile = function (file) {\n      console.log('remove', file);\n\n      var index = vm.files.indexOf(file);\n\n      // Remove from list\n      if (index === 0) {\n        if (vm.files && vm.files.length > 1) {\n          // HACK to remove from first position and to release from CSS animation duration\n          // if it is just removed from vm.files it will stay on first place for 3 seconds before delete\n          // bacause of CSS animation duration\n          $timeout(function () {\n            jQuery('li#media-1').trigger({ type:'mousedown', which:1 });\n            vm.files.splice(1, 1);\n          });\n          // set to second place\n          // index = 1;\n        } else {\n          vm.files.splice(0, 1);\n        }\n      } else {\n        if (index > -1) {\n          // remove at index\n          vm.files.splice(index, 1);\n        }\n      }\n\n      // remove from cache if exists\n      var indexInCache = -1;\n      // get fresh data from local storage if some changes are made\n      cachedMedia = localStorageService.get('cachedMedia');\n      for (var i = 0; i < cachedMedia.length; i++) {\n        if (cachedMedia[i] && file) {\n          if (cachedMedia[i].url === file.url) {\n            indexInCache = i;\n          }\n        }\n      }\n\n      // console.log('indexInCache', indexInCache);\n      if (indexInCache > -1) {\n        cachedMedia.splice(indexInCache, 1);\n        updateCachedMedia(cachedMedia);\n      }\n    }\n\n    /**\n     * Handle media from the UI\n     */\n    vm.handleFile = function (file, event) {\n      switch(event.which) {\n        case 1: // this is left click\n        var index = vm.files.indexOf(file);\n            vm.changeMainFile(index);\n            break;\n        case 2: // in case you need some middle click things\n            vm.removeFile(file);\n            break;\n        case 3: // this is right click\n            // right click makes problems\n            //removeFile();\n            break;\n        default:\n            break;\n      }\n\n    }\n\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .controller('WallController', WallController);\n\n  /** @ngInject */\n  function WallController($scope, $state, $stateParams, $timeout, $log, cfpLoadingBar, WallService, ExifService, $sails, $sce, $window, localStorageService) {\n    var vm = this;\n\n    // cache with local storage\n    var updateCachedMedia = function (updatedCachedMedia) {\n      localStorageService.set('cachedMedia', updatedCachedMedia);\n    }\n\n    vm.wallMode = 'watch';\n\n    var cachedMedia = localStorageService.get('cachedMedia');\n    if (!cachedMedia) {\n      cachedMedia = [];\n      updateCachedMedia(cachedMedia);\n    }\n\n    console.log('paramsi', $stateParams);\n\n    vm.files = [];\n    if ($state.current.name === 'wall') {\n      if (cachedMedia && cachedMedia.length > 0) {\n        vm.files = cachedMedia;\n      }\n    }\n    vm.mainFile = null;\n\n    // UI flags for show/hide\n    vm.flags = {};\n\n    vm.isActiveMainImage = false;\n\n    var wallPassword = $stateParams.password || $stateParams.wallPassword || localStorageService.get('wall').password;\n    var wallMasterKey = $stateParams.masterKey;\n\n    if ($state.current.name === 'wallVerify' || $state.current.name === 'wallVerifyRemote') {\n      vm.isVerifyPage = true;\n    }\n\n    // Current authenticated wall\n    var wall = WallService.current();\n\n    if (!wall) {\n      $state.go('home');\n    }\n\n    var id = null;\n    if (wall && wall.id) {\n      id = wall.id;\n    }\n\n    if (!id) {\n      return;\n    }\n\n    if (wall.image) {\n      vm.image = wall.image;\n    }\n\n    var roomName = 'wall' + id;\n\n    // Sails.js SOCKET suff --------------------------\n    //\n    // Unsubscribe on scope destory\n    $scope.$on('$destroy', function () {\n      $sails.delete(\"/notify/unsubscribe\", { roomName: roomName })\n        .then(function (resp) {\n          $log.info('Unubscribe OK', resp)\n        }, function (resp) {\n          $log.error('Unubscribe NOT OK', resp)\n        });\n      $sails.removeAllListeners();\n\n      if (thisChangedTimeout) {\n        $timeout.cancel(thisChangedTimeout);\n      }\n    });\n\n    var isConnected = false;\n    // Subscribe to Sails server for listen for changes\n    $sails.on(\"connect\", function () {\n      $log.info('Connected to Sails from first try');\n      $sails.post(\"/notify/subscribe\", { roomName: roomName })\n        .then(function (resp) {\n          $log.info('Subscribe OK', resp)\n          isConnected = true;\n        }, function (resp) {\n          $log.error('Subscribe NOT OK', resp)\n        });\n    });\n\n    // TODO(stepanic): refactor this code and remove redundant code\n    $timeout(function () {\n      if (!isConnected) {\n        $sails.post(\"/notify/subscribe\", { roomName: roomName })\n          .then(function (resp) {\n            $log.info('Subscribe OK when connected', resp)\n            isConnected = true;\n          }, function (resp) {\n            $log.error('Subscribe NOT OK when connected', resp)\n          });\n      }\n    }, 2000);\n\n    // Listen for changes and update $scope\n    var thisChangedTimeout = null;\n    // Watching for updates\n    $sails.on(\"notify\", function (files) {\n      $log.info('Notify', files);\n      // Update UI on new data\n      updateUI();\n\n      vm.isActiveMainImage = true;\n\n      $timeout(function() {\n        vm.isActiveMainImage = false;\n      }, 5000);\n\n      if (vm.files[0]) {\n        vm.files[0].controls = false;\n      }\n\n      for (var i = 0; i < files.length; i++) {\n        getOrientation(files[i]);\n      }\n    });\n\n    // Watching for updates\n    $sails.on(\"notify-remote-approve\", function (approvedFile) {\n      $log.info('notify-remote-approve', approvedFile);\n\n      // This should not be executed on wallVerifyRemote\n      if ($state.current.name === 'wallVerify') {\n        vm.files.forEach(function(existingFile) {\n          if (existingFile.url === approvedFile.url) {\n            existingFile.checked = true;\n            vm.verifyFile(existingFile);\n            $log.info('Approved file is found and verified', existingFile);\n          }\n        });\n      }\n    });\n    $sails.on(\"notify-remote-disapprove\", function (disapprovedFile) {\n      $log.info('notify-remote-disapprove', disapprovedFile);\n\n      // This should not be executed on wallVerifyRemote\n      if ($state.current.name === 'wallVerify') {\n        vm.files.forEach(function(existingFile) {\n          if (existingFile.url === disapprovedFile.url) {\n            vm.unverifyFile(existingFile);\n            $log.info('Disapproved file is found and unverified', existingFile);\n          }\n        });\n      }\n    });\n    // END - Sails.js SOCKET suff --------------------------\n\n    function getOrientation(file) {\n      ExifService.getOrientation(file.url, function (orientation) {\n        file.orientation = orientation;\n        file.trustedUrl = $sce.trustAsResourceUrl(file.url);\n        $scope.$apply(function () {\n          if ($state.current.name === 'wall') {\n            // Keep DESC order\n            // Add to start of array\n            vm.files.unshift(file);\n            vm.mainFile = file;\n          } else {\n            // Keep ASC order\n            vm.files.push(file);\n            if (vm.files.length === 1) {\n              vm.mainFile = file;\n            }\n          }\n\n          if ($state.current.name === 'wall') {\n            // Main photo + 24 at mosaic\n            vm.files = vm.files.slice(0, 25);\n          }\n\n          // Skip manual check if server has checked it!\n          if ($state.current.name === 'wallVerify') {\n            $log.info('wallVerify', file);\n            if (file.checked === true) {\n              vm.verifyFile(file);\n            }\n          }\n        });\n      });\n    }\n\n    function updateUI() {\n      $scope.windowInnerHeight = $window.innerHeight;\n      $scope.windowInnerWidth = $window.innerWidth;\n      if ($state.current.name === 'wall') {\n        $scope.firstImageWidth = $scope.windowInnerWidth;\n        $timeout(function () {\n          // Return to 80% of window width after 10 seconds\n          $scope.firstImageWidth = $scope.windowInnerWidth * 0.8;\n        }, 10000);\n      }\n    }\n\n    // Update on load\n    updateUI();\n\n    // updateUI on window resize\n    var w = angular.element($window);\n    w.bind('resize', function () {\n      $scope.$apply(function () {\n        updateUI();\n      });\n    });\n\n    vm.changeMainFile = function (key) {\n      var old = vm.files[0];\n      old.controls = false;\n      vm.files[0] = vm.files[key];\n      if (vm.files[0]) {\n        vm.files[0].controls = true;\n      }\n      if (old) {\n        vm.files[key] = old;\n      }\n    }\n\n    vm.removeFile = function (file) {\n      console.log('file to remove', file);\n    }\n\n    vm.ToggleWallMode = function() {\n      // $state.go('wallVerifiedDirect', { wallPassword: wallPassword });\n      $state.go('wallVerified');\n    }\n\n    vm.GoToRecord = function() {\n      $state.go('record');\n    }\n\n    vm.verifyFile = function (file) {\n\n      // Get fresh data if some media is removed to avoid adding removed again\n      cachedMedia = localStorageService.get('cachedMedia');\n      cachedMedia.unshift(file);\n      updateCachedMedia(cachedMedia);\n\n      try {\n        // Send to WallVerifiedController\n        if (crosstab.supported) {\n          crosstab.broadcast('wallNewMedia', file, null);\n        } else {\n          $log.info('Crosstab is not supported, try over sockets, NOTE: password and masterKey are required');\n        }\n      } catch (e) {\n        $log.error(e);\n      }\n\n      // Remote verify\n      if ($state.current.name === 'wallVerifyRemote' && wallPassword && wallMasterKey) {\n        WallService.approveFile(file, wallPassword, wallMasterKey, function (file, error) {\n          if (error) {\n            $log.error('File is not approved, error: ', error);\n          } else {\n            $log.info('File is approved', file);\n          }\n        });\n      }\n\n      // Remove from list\n      var index = vm.files.indexOf(file);\n      if (index > -1) {\n        vm.files.splice(index, 1);\n      }\n\n      // REFACTORED(stepanic): this remove first item\n      // vm.files.shift();\n    }\n\n    vm.unverifyFile = function (file) {\n      // Remove from list\n      var index = vm.files.indexOf(file);\n      if (index > -1) {\n        vm.files.splice(index, 1);\n      }\n\n      // REFACTORED(stepanic): this remove first item\n      // vm.files.shift();\n\n      // Remote unverify\n      if ($state.current.name === 'wallVerifyRemote' && wallPassword && wallMasterKey) {\n        WallService.disapproveFile(file, wallPassword, wallMasterKey, function (file, error) {\n          if (error) {\n            $log.error('File is not disapproved, error: ', error);\n          } else {\n            $log.info('File is disapproved', file);\n          }\n        });\n      }\n    }\n\n    /**\n     * Handle media from the UI\n     */\n    vm.handleFile = function (file, event) {\n      var index = vm.files.indexOf(file);\n\n      switch(event.which) {\n        case 1: // this is left click\n            vm.changeMainFile(index);\n            break;\n        case 2: // in case you need some middle click things\n            // Remove from list\n            if (index === 0) {\n              $scope.$apply(function() {\n              vm.files.shift();\n\n              });\n              // if (vm.files && vm.files.length > 1) {\n                // replace with second\n                // vm.changeMainFile(1);\n                // set to second place\n                // index = 1;\n              // }\n            } else {\n              if (index > -1) {\n                // remove at index\n                vm.files.splice(index, 1);\n              }\n            }\n            break;\n        case 3: // this is right click\n            break;\n        default:\n            break;\n      }\n\n    }\n\n\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .directive('ngMuted', function(){\n      return {\n        priority: 99, // it needs to run after the attributes are interpolated\n        link: function(scope, element, attr) {\n\n          attr.$observe('ngMuted', function(value) {\n            if (value != 'false') {\n              element[0].muted = true;\n            }\n            else{\n              element[0].muted = false;\n            }\n          });\n        }\n      }\n    });\n\n})();\n\n\n\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .directive('ngControls', function(){\n      return {\n        priority: 99, // it needs to run after the attributes are interpolated\n        link: function(scope, element, attr) {\n\n          attr.$observe('ngControls', function(value) {\n            if (value != 'false') {\n              element[0].controls = true;\n            }\n            else{\n              element[0].controls = false;\n            }\n          });\n        }\n      }\n    });\n\n})();\n\n\n\n\n(function() {\n  'use strict';\n\n  angular\n      .module('mediaWall')\n      .service('ExifService', ExifService);\n\n  /** @ngInject */\n  function ExifService($log) {\n\n    function getOrientation(imageUrl, callback) {\n      var xhr = new XMLHttpRequest();\n      xhr.open(\"GET\", imageUrl, true);\n      xhr.responseType = \"arraybuffer\";\n      xhr.onload = function(e) {\n        var arrayBuffer = new Uint8Array(this.response);\n        var exifData = EXIF.readFromBinaryFile(arrayBuffer.buffer);\n\n        $log.info(exifData);\n\n        callback(parseInt(exifData.Orientation || 1, 10));\n      };\n      xhr.send();\n    }\n\n    return {\n      getOrientation: getOrientation\n    }\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .controller('RecordController', RecordController);\n\n  /** @ngInject */\n  function RecordController($scope, $state, $stateParams, $log, $timeout, $mdDialog, $window, WallService, UploadService, deviceDetector, cfpLoadingBar, localStorageService, validator, eachSeries, $q) {\n    var vm = this;\n\n    $log.info('deviceDetector', deviceDetector);\n\n    var wallMasterKey = $stateParams.masterKey;\n\n    if (!wallMasterKey) {\n      // TODO(stepanic): this is hack to go to top of the window to avoid empty space\n      // because of opened keyboard from previous page\n      if (deviceDetector.os === 'ios' || deviceDetector.os === 'android' || deviceDetector.os === 'windows-phone') {\n        window.location = '/fotkaj#';\n      }\n    }\n\n    $scope.showProgressBar = false;\n\n    // REFACTORED(stepanic): this is annoying for first time users, show only on info click\n    // If currentEmail is undefined show prompts by default\n    // if (!localStorageService.get('currentEmail')) {\n    //   showInfoPrompts();\n    // }\n\n    var disableInteraction = null;\n\n    $scope.progressCounter = 0;\n\n    $scope.wall = WallService.current();\n\n    if (!$scope.wall) {\n      $state.go('home');\n    }\n\n    function applyProgress(value) {\n      $scope.$apply(function () {\n        $scope.progressCounter = value * 100;\n      });\n      cfpLoadingBar.set(value);\n    }\n\n    function showAlert (message) {\n      // TODO(stepanic): improve with $mdDialog\n      alert(message);\n    };\n\n    $scope.HandleFiles = function (files) {\n\n      $scope.showProgressBar = true;\n\n      cfpLoadingBar.start();\n      cfpLoadingBar.set(0);\n      $scope.progressCounter = 0;\n\n      var filesInArray = [];\n      angular.forEach(files, function(file) {\n        filesInArray.push (file);\n      });\n\n      var currentFileIndex = -1;\n\n      // Async series implementation for angular\n      eachSeries(filesInArray, asyncFilesUploadHandler).then(function () {\n        // All done\n        $log.info('All files are uploaded');\n\n        // Keep 100% for 0.5 second\n        setTimeout(function() {\n          applyProgress(0);\n          $scope.showProgressBar = false;\n        }, 500);\n        cfpLoadingBar.complete();\n        $scope.progressCounter = 0;\n      });\n\n\n      function asyncFilesUploadHandler (file) {\n        var deferred = $q.defer();\n\n        // TODO(stepanic): test if maybe is better to upload files in subsets of max for example 5MB\n        // this can be checked with sum of file.size\n        var separatedFiles = [file];\n\n        // Files iterator\n        currentFileIndex += 1;\n\n        UploadService.files(separatedFiles, function (error, data) {\n          $log.info(\"UploadService done\", currentFileIndex, separatedFiles, data);\n\n          if (deviceDetector.os === 'ios' || deviceDetector.os === 'android' || deviceDetector.os === 'windows-phone') {\n            if (data && data.files && data.files[0] && data.files[0].type.startsWith('video/')) {\n              // showAlert (\"Vaš video zapis je zaprimljen.\");\n            }\n          }\n\n          deferred.resolve();\n\n          // TODO(stepanic): find better way to preview uploaded files if it is necessarily\n          // this is annoying\n          // if (error) {\n          //   return;\n          // }\n\n          if (files && files[0]) {\n          //   // Images\n          //   // Open image which user can save to device or back to record\n            download(files[0]);\n          }\n        }, function uploadProgress(event) {\n          // var progress = (currentFileIndex + event.loaded / event.total) * 1 / filesInArray.length;\n\n          // Offset between other files\n          var offset = currentFileIndex / files.length;\n\n          // Local Progress for every file\n          var progress = event.loaded / event.total / files.length;\n\n          // Absolute progress 0% to 100%\n          var absoluteProgress = offset + progress;\n\n          applyProgress(absoluteProgress);\n\n        }, wallMasterKey);\n\n        // Returns a promise\n        return deferred.promise;\n      }\n\n    };\n\n    var goToProfile = function () {\n      $state.go('profile');\n    };\n\n    vm.EditProfile = function () {\n      goToProfile();\n    };\n\n    vm.GoToWall = function () {\n      $state.go('wall');\n    };\n\n    vm.GoToHomepage = function () {\n      var confirm = $window.confirm(\"Jeste li sigurni da želite izaći iz vjenčanja?\");\n      if (confirm) {\n        $state.go('home');\n      }\n    };\n\n    vm.GoToGallery = function () {\n      var wall = WallService.current();\n      if (wall.googleDriveFolderId) {\n        // $state.go('gallery');\n        var prefix = \"https://drive.google.com/drive/folders/\";\n        // iOS and Android devices usually have installed native Google Drive apps\n        // and than target=\"_blank\" on return to app show empty white screen\n        if (deviceDetector.os === 'ios' || deviceDetector.os === 'android') {\n          $window.open(prefix + wall.googleDriveFolderId, \"_parent\");\n        } else {\n          $window.open(prefix + wall.googleDriveFolderId, \"_blank\");\n        }\n      }\n    };\n\n\n    function download(file) {\n      // TODO(stepanic): skip this for files from gallery, ony from camera source\n      // iOS and Adnroid devices do not store image taken with camera, this is fix\n      // Apple has not implemented automatic download, should be triggered with user interaction with tap/click\n      if (deviceDetector.os === 'ios' || deviceDetector.os === 'android') {\n        var reader = new FileReader();\n\n        reader.onload = function (e) {\n          $log.info(e);\n\n          // Only show/download images\n          // iOS is not able to download video files in browser\n          if (deviceDetector.os === 'ios') {\n            if (!e.target.result.startsWith('data:image/')) {\n              return;\n            }\n          }\n\n          // var data = e.target.result.split('base64');\n          // data = 'data:application/octet-stream;base64' + data[1];\n\n          var data = e.target.result;\n          var filename = file.name;\n\n          var element = document.createElement('a');\n          element.setAttribute('href', data);\n          element.setAttribute('download', filename);\n\n\n          function errorHandler(e) {\n            var msg = '';\n\n            switch (e.code) {\n              case FileError.QUOTA_EXCEEDED_ERR:\n                msg = 'QUOTA_EXCEEDED_ERR';\n                break;\n              case FileError.NOT_FOUND_ERR:\n                msg = 'NOT_FOUND_ERR';\n                break;\n              case FileError.SECURITY_ERR:\n                msg = 'SECURITY_ERR';\n                break;\n              case FileError.INVALID_MODIFICATION_ERR:\n                msg = 'INVALID_MODIFICATION_ERR';\n                break;\n              case FileError.INVALID_STATE_ERR:\n                msg = 'INVALID_STATE_ERR';\n                break;\n              default:\n                msg = 'Unknown Error';\n                break;\n            };\n\n            console.log('Error: ' + msg);\n          }\n\n          function onInitFs(fs) {\n\n\n\n              (function(f) {\n                fs.root.getFile(f.name, {create: true, exclusive: true}, function(fileEntry) {\n                  fileEntry.createWriter(function(fileWriter) {\n                    fileWriter.write(f); // Note: write() can take a File or Blob object.\n                  }, errorHandler);\n                }, errorHandler);\n              })(file);\n\n            }\n\n\n\n          window.webkitStorageInfo.requestQuota(PERSISTENT, 5*1024*1024, function(grantedBytes) {\n            window.requestFileSystem(PERSISTENT, grantedBytes, onInitFs, errorHandler);\n          }, function(e) {\n            console.log('Error', e);\n          });\n\n\n          // element.style.display = 'none';\n          // document.body.appendChild(element);\n\n          // element.click();\n\n          document.body.removeChild(element);\n        }\n\n        reader.readAsDataURL(file);\n      }\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .directive('fileModel', ['$parse', function ($parse) {\n      return {\n          restrict: 'A',\n          link: function(scope, element, attrs) {\n              var model = $parse(attrs.fileModel);\n              var modelSetter = model.assign;\n\n              element.bind('change', function(){\n                  scope.$apply(function(){\n                      modelSetter(scope, element[0].files[0]);\n                  });\n              });\n          }\n      };\n    }]);\n\n})();\n\n\n\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .controller('ProfileController', ProfileController);\n\n  /** @ngInject */\n  function ProfileController($scope, $state, localStorageService, $timeout, validator) {\n    var vm = this;\n\n    vm.email = '';\n    vm.displayName = '';\n\n    if (localStorageService.get('currentEmail')) {\n      vm.email = localStorageService.get('currentEmail');\n    }\n\n    if (localStorageService.get('currentDisplayName')) {\n      vm.displayName = localStorageService.get('currentDisplayName');\n    }\n\n    vm.saveProfileAndReturnToRecord = function () {\n\n      // Email can be empty\n      if (vm.email && !validator.isValidEmail(vm.email)) {\n        vm.invalidEmail = true;\n\n        $timeout(function() {\n          vm.invalidEmail = false;\n        }, 3000);\n\n        return;\n      }\n\n      console.log(vm.email, vm.displayName);\n\n      // Store\n      localStorageService.set('currentEmail', vm.email ? vm.email : '');\n      localStorageService.set('currentDisplayName', vm.displayName ? vm.displayName : '');\n\n      $state.go('record');\n    };\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .controller('InfoController', InfoController);\n\n  /** @ngInject */\n  function InfoController($scope) {\n    var vm = this;\n\n\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .controller('HomeController', HomeController);\n\n  /** @ngInject */\n  function HomeController($scope, $state, $stateParams, $timeout, $log, cfpLoadingBar, WallService, localStorageService) {\n    var vm = this;\n\n    vm.password = '';\n    vm.passwordIsFocused = true;\n\n    vm.pin = '';\n    vm.pinIsFocused = false;\n    var failedPinTry = '';\n\n    $scope.SetValidPin = function (pin) {\n      vm.pin = pin;\n      vm.wrongPin = false;\n      $log.log(\"PIN: \", pin);\n      if (vm.pin.length === 4) {\n        if (failedPinTry !== vm.pin) {\n          WallService.auth(vm.wall.id, vm.password, vm.pin, function (wall, error) {\n            if (error) {\n              vm.wrongPin = true;\n              failedPinTry = vm.pin;\n            } else {\n              vm.wall = wall;\n\n              // reset cache before next login\n              var cachedMedia = [];\n              localStorageService.set('cachedMedia', cachedMedia);\n\n              $state.go('record');\n            }\n            cfpLoadingBar.complete();\n          });\n        }\n      }\n    }\n\n    vm.GoToRecord = function () {\n      vm.wrongPassword = false;\n      vm.pinIsFocused = false;\n      vm.wall = null;\n      cfpLoadingBar.start();\n\n      vm.password = vm.password.toLowerCase();\n\n      WallService.info(vm.password, function (wall, error) {\n        $log.log(wall, error);\n        if (error) {\n          vm.wrongPassword = true;\n        } else {\n          vm.wall = wall;\n          if (!wall.hasPin) {\n\n            // reset cache before next login\n            var cachedMedia = [];\n            localStorageService.set('cachedMedia', cachedMedia);\n\n            $state.go('record');\n          } else {\n            vm.pinIsFocused = true;\n          }\n        }\n        cfpLoadingBar.complete();\n      });\n    };\n\n    if ($stateParams.wallPassword) {\n      vm.password = $stateParams.wallPassword;\n      vm.GoToRecord();\n    }\n\n    vm.activeTab = 0;\n\n    vm.OpenTab = function (tabId) {\n      if (vm.activeTab === tabId) {\n        vm.activeTab = 0;\n      } else {\n        vm.activeTab = tabId;\n      }\n    }\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .directive('focusMe', function($timeout) {\n      return {\n          link: function ( scope, element, attrs ) {\n              scope.$watch( attrs.focusMe, function ( val ) {\n                  if ( angular.isDefined( val ) && val ) {\n                      $timeout( function () { element[0].focus(); } );\n                  }\n              }, true);\n          }\n      };\n  });\n\n})();\n\n\n\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall.helpers', []);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall.helpers')\n    .service('validator', validator);\n\n  /** @ngInject */\n  function validator() {\n\n    var EMAIL_REGEXP = /^[_a-z0-9]+(\\.[_a-z0-9]+)*(\\+[a-z0-9-]+)?@[a-z0-9-]+(\\.[a-z0-9-]+)*(\\.[a-z]{2,15})$/;\n\n    function isValidEmail(email) {\n      // For empty strings\n      if (!email || email.length === 0) {\n        return false;\n      }\n      return EMAIL_REGEXP.test(email);\n    }\n\n    return {\n      isValidEmail: isValidEmail\n    }\n  }\n\n\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall.helpers')\n    .service('stringHelpers', stringHelpers);\n\n  /** @ngInject */\n  function stringHelpers() {\n\n    function transliterateCyrillicToLatin(word){\n        var answer = \"\"\n          , a = {};\n\n       a[\"Ё\"]=\"YO\";a[\"Й\"]=\"I\";a[\"Ц\"]=\"TS\";a[\"У\"]=\"U\";a[\"К\"]=\"K\";a[\"Е\"]=\"E\";a[\"Н\"]=\"N\";a[\"Г\"]=\"G\";a[\"Ш\"]=\"SH\";a[\"Щ\"]=\"SCH\";a[\"З\"]=\"Z\";a[\"Х\"]=\"H\";a[\"Ъ\"]=\"'\";\n       a[\"ё\"]=\"yo\";a[\"й\"]=\"i\";a[\"ц\"]=\"ts\";a[\"у\"]=\"u\";a[\"к\"]=\"k\";a[\"е\"]=\"e\";a[\"н\"]=\"n\";a[\"г\"]=\"g\";a[\"ш\"]=\"sh\";a[\"щ\"]=\"sch\";a[\"з\"]=\"z\";a[\"х\"]=\"h\";a[\"ъ\"]=\"'\";\n       a[\"Ф\"]=\"F\";a[\"Ы\"]=\"I\";a[\"В\"]=\"V\";a[\"А\"]=\"a\";a[\"П\"]=\"P\";a[\"Р\"]=\"R\";a[\"О\"]=\"O\";a[\"Л\"]=\"L\";a[\"Д\"]=\"D\";a[\"Ж\"]=\"ZH\";a[\"Э\"]=\"E\";\n       a[\"ф\"]=\"f\";a[\"ы\"]=\"i\";a[\"в\"]=\"v\";a[\"а\"]=\"a\";a[\"п\"]=\"p\";a[\"р\"]=\"r\";a[\"о\"]=\"o\";a[\"л\"]=\"l\";a[\"д\"]=\"d\";a[\"ж\"]=\"zh\";a[\"э\"]=\"e\";\n       a[\"Я\"]=\"Ya\";a[\"Ч\"]=\"CH\";a[\"С\"]=\"S\";a[\"М\"]=\"M\";a[\"И\"]=\"I\";a[\"Т\"]=\"T\";a[\"Ь\"]=\"'\";a[\"Б\"]=\"B\";a[\"Ю\"]=\"YU\";\n       a[\"я\"]=\"ya\";a[\"ч\"]=\"ch\";a[\"с\"]=\"s\";a[\"м\"]=\"m\";a[\"и\"]=\"i\";a[\"т\"]=\"t\";a[\"ь\"]=\"'\";a[\"б\"]=\"b\";a[\"ю\"]=\"yu\";\n\n       for (var i in word){\n         if (word.hasOwnProperty(i)) {\n           if (a[word[i]] === undefined){\n             answer += word[i];\n           } else {\n             answer += a[word[i]];\n           }\n         }\n       }\n       return answer;\n    }\n\n    function replaceDiacritics (str) {\n\n      var defaultDiacriticsRemovalMap = [\n        {'base':'A', 'letters':/[\\u0041\\u24B6\\uFF21\\u00C0\\u00C1\\u00C2\\u1EA6\\u1EA4\\u1EAA\\u1EA8\\u00C3\\u0100\\u0102\\u1EB0\\u1EAE\\u1EB4\\u1EB2\\u0226\\u01E0\\u00C4\\u01DE\\u1EA2\\u00C5\\u01FA\\u01CD\\u0200\\u0202\\u1EA0\\u1EAC\\u1EB6\\u1E00\\u0104\\u023A\\u2C6F]/g},\n        {'base':'AA','letters':/[\\uA732]/g},\n        {'base':'AE','letters':/[\\u00C6\\u01FC\\u01E2]/g},\n        {'base':'AO','letters':/[\\uA734]/g},\n        {'base':'AU','letters':/[\\uA736]/g},\n        {'base':'AV','letters':/[\\uA738\\uA73A]/g},\n        {'base':'AY','letters':/[\\uA73C]/g},\n        {'base':'B', 'letters':/[\\u0042\\u24B7\\uFF22\\u1E02\\u1E04\\u1E06\\u0243\\u0182\\u0181]/g},\n        {'base':'C', 'letters':/[\\u0043\\u24B8\\uFF23\\u0106\\u0108\\u010A\\u010C\\u00C7\\u1E08\\u0187\\u023B\\uA73E]/g},\n        {'base':'D', 'letters':/[\\u0044\\u24B9\\uFF24\\u1E0A\\u010E\\u1E0C\\u1E10\\u1E12\\u1E0E\\u0110\\u018B\\u018A\\u0189\\uA779]/g},\n        {'base':'DZ','letters':/[\\u01F1\\u01C4]/g},\n        {'base':'Dz','letters':/[\\u01F2\\u01C5]/g},\n        {'base':'E', 'letters':/[\\u0045\\u24BA\\uFF25\\u00C8\\u00C9\\u00CA\\u1EC0\\u1EBE\\u1EC4\\u1EC2\\u1EBC\\u0112\\u1E14\\u1E16\\u0114\\u0116\\u00CB\\u1EBA\\u011A\\u0204\\u0206\\u1EB8\\u1EC6\\u0228\\u1E1C\\u0118\\u1E18\\u1E1A\\u0190\\u018E]/g},\n        {'base':'F', 'letters':/[\\u0046\\u24BB\\uFF26\\u1E1E\\u0191\\uA77B]/g},\n        {'base':'G', 'letters':/[\\u0047\\u24BC\\uFF27\\u01F4\\u011C\\u1E20\\u011E\\u0120\\u01E6\\u0122\\u01E4\\u0193\\uA7A0\\uA77D\\uA77E]/g},\n        {'base':'H', 'letters':/[\\u0048\\u24BD\\uFF28\\u0124\\u1E22\\u1E26\\u021E\\u1E24\\u1E28\\u1E2A\\u0126\\u2C67\\u2C75\\uA78D]/g},\n        {'base':'I', 'letters':/[\\u0049\\u24BE\\uFF29\\u00CC\\u00CD\\u00CE\\u0128\\u012A\\u012C\\u0130\\u00CF\\u1E2E\\u1EC8\\u01CF\\u0208\\u020A\\u1ECA\\u012E\\u1E2C\\u0197]/g},\n        {'base':'J', 'letters':/[\\u004A\\u24BF\\uFF2A\\u0134\\u0248]/g},\n        {'base':'K', 'letters':/[\\u004B\\u24C0\\uFF2B\\u1E30\\u01E8\\u1E32\\u0136\\u1E34\\u0198\\u2C69\\uA740\\uA742\\uA744\\uA7A2]/g},\n        {'base':'L', 'letters':/[\\u004C\\u24C1\\uFF2C\\u013F\\u0139\\u013D\\u1E36\\u1E38\\u013B\\u1E3C\\u1E3A\\u0141\\u023D\\u2C62\\u2C60\\uA748\\uA746\\uA780]/g},\n        {'base':'LJ','letters':/[\\u01C7]/g},\n        {'base':'Lj','letters':/[\\u01C8]/g},\n        {'base':'M', 'letters':/[\\u004D\\u24C2\\uFF2D\\u1E3E\\u1E40\\u1E42\\u2C6E\\u019C]/g},\n        {'base':'N', 'letters':/[\\u004E\\u24C3\\uFF2E\\u01F8\\u0143\\u00D1\\u1E44\\u0147\\u1E46\\u0145\\u1E4A\\u1E48\\u0220\\u019D\\uA790\\uA7A4]/g},\n        {'base':'NJ','letters':/[\\u01CA]/g},\n        {'base':'Nj','letters':/[\\u01CB]/g},\n        {'base':'O', 'letters':/[\\u004F\\u24C4\\uFF2F\\u00D2\\u00D3\\u00D4\\u1ED2\\u1ED0\\u1ED6\\u1ED4\\u00D5\\u1E4C\\u022C\\u1E4E\\u014C\\u1E50\\u1E52\\u014E\\u022E\\u0230\\u00D6\\u022A\\u1ECE\\u0150\\u01D1\\u020C\\u020E\\u01A0\\u1EDC\\u1EDA\\u1EE0\\u1EDE\\u1EE2\\u1ECC\\u1ED8\\u01EA\\u01EC\\u00D8\\u01FE\\u0186\\u019F\\uA74A\\uA74C]/g},\n        {'base':'OI','letters':/[\\u01A2]/g},\n        {'base':'OO','letters':/[\\uA74E]/g},\n        {'base':'OU','letters':/[\\u0222]/g},\n        {'base':'P', 'letters':/[\\u0050\\u24C5\\uFF30\\u1E54\\u1E56\\u01A4\\u2C63\\uA750\\uA752\\uA754]/g},\n        {'base':'Q', 'letters':/[\\u0051\\u24C6\\uFF31\\uA756\\uA758\\u024A]/g},\n        {'base':'R', 'letters':/[\\u0052\\u24C7\\uFF32\\u0154\\u1E58\\u0158\\u0210\\u0212\\u1E5A\\u1E5C\\u0156\\u1E5E\\u024C\\u2C64\\uA75A\\uA7A6\\uA782]/g},\n        {'base':'S', 'letters':/[\\u0053\\u24C8\\uFF33\\u1E9E\\u015A\\u1E64\\u015C\\u1E60\\u0160\\u1E66\\u1E62\\u1E68\\u0218\\u015E\\u2C7E\\uA7A8\\uA784]/g},\n        {'base':'T', 'letters':/[\\u0054\\u24C9\\uFF34\\u1E6A\\u0164\\u1E6C\\u021A\\u0162\\u1E70\\u1E6E\\u0166\\u01AC\\u01AE\\u023E\\uA786]/g},\n        {'base':'TZ','letters':/[\\uA728]/g},\n        {'base':'U', 'letters':/[\\u0055\\u24CA\\uFF35\\u00D9\\u00DA\\u00DB\\u0168\\u1E78\\u016A\\u1E7A\\u016C\\u00DC\\u01DB\\u01D7\\u01D5\\u01D9\\u1EE6\\u016E\\u0170\\u01D3\\u0214\\u0216\\u01AF\\u1EEA\\u1EE8\\u1EEE\\u1EEC\\u1EF0\\u1EE4\\u1E72\\u0172\\u1E76\\u1E74\\u0244]/g},\n        {'base':'V', 'letters':/[\\u0056\\u24CB\\uFF36\\u1E7C\\u1E7E\\u01B2\\uA75E\\u0245]/g},\n        {'base':'VY','letters':/[\\uA760]/g},\n        {'base':'W', 'letters':/[\\u0057\\u24CC\\uFF37\\u1E80\\u1E82\\u0174\\u1E86\\u1E84\\u1E88\\u2C72]/g},\n        {'base':'X', 'letters':/[\\u0058\\u24CD\\uFF38\\u1E8A\\u1E8C]/g},\n        {'base':'Y', 'letters':/[\\u0059\\u24CE\\uFF39\\u1EF2\\u00DD\\u0176\\u1EF8\\u0232\\u1E8E\\u0178\\u1EF6\\u1EF4\\u01B3\\u024E\\u1EFE]/g},\n        {'base':'Z', 'letters':/[\\u005A\\u24CF\\uFF3A\\u0179\\u1E90\\u017B\\u017D\\u1E92\\u1E94\\u01B5\\u0224\\u2C7F\\u2C6B\\uA762]/g},\n        {'base':'a', 'letters':/[\\u0061\\u24D0\\uFF41\\u1E9A\\u00E0\\u00E1\\u00E2\\u1EA7\\u1EA5\\u1EAB\\u1EA9\\u00E3\\u0101\\u0103\\u1EB1\\u1EAF\\u1EB5\\u1EB3\\u0227\\u01E1\\u00E4\\u01DF\\u1EA3\\u00E5\\u01FB\\u01CE\\u0201\\u0203\\u1EA1\\u1EAD\\u1EB7\\u1E01\\u0105\\u2C65\\u0250]/g},\n        {'base':'aa','letters':/[\\uA733]/g},\n        {'base':'ae','letters':/[\\u00E6\\u01FD\\u01E3]/g},\n        {'base':'ao','letters':/[\\uA735]/g},\n        {'base':'au','letters':/[\\uA737]/g},\n        {'base':'av','letters':/[\\uA739\\uA73B]/g},\n        {'base':'ay','letters':/[\\uA73D]/g},\n        {'base':'b', 'letters':/[\\u0062\\u24D1\\uFF42\\u1E03\\u1E05\\u1E07\\u0180\\u0183\\u0253]/g},\n        {'base':'c', 'letters':/[\\u0063\\u24D2\\uFF43\\u0107\\u0109\\u010B\\u010D\\u00E7\\u1E09\\u0188\\u023C\\uA73F\\u2184]/g},\n        {'base':'d', 'letters':/[\\u0064\\u24D3\\uFF44\\u1E0B\\u010F\\u1E0D\\u1E11\\u1E13\\u1E0F\\u0111\\u018C\\u0256\\u0257\\uA77A]/g},\n        {'base':'dz','letters':/[\\u01F3\\u01C6]/g},\n        {'base':'e', 'letters':/[\\u0065\\u24D4\\uFF45\\u00E8\\u00E9\\u00EA\\u1EC1\\u1EBF\\u1EC5\\u1EC3\\u1EBD\\u0113\\u1E15\\u1E17\\u0115\\u0117\\u00EB\\u1EBB\\u011B\\u0205\\u0207\\u1EB9\\u1EC7\\u0229\\u1E1D\\u0119\\u1E19\\u1E1B\\u0247\\u025B\\u01DD]/g},\n        {'base':'f', 'letters':/[\\u0066\\u24D5\\uFF46\\u1E1F\\u0192\\uA77C]/g},\n        {'base':'g', 'letters':/[\\u0067\\u24D6\\uFF47\\u01F5\\u011D\\u1E21\\u011F\\u0121\\u01E7\\u0123\\u01E5\\u0260\\uA7A1\\u1D79\\uA77F]/g},\n        {'base':'h', 'letters':/[\\u0068\\u24D7\\uFF48\\u0125\\u1E23\\u1E27\\u021F\\u1E25\\u1E29\\u1E2B\\u1E96\\u0127\\u2C68\\u2C76\\u0265]/g},\n        {'base':'hv','letters':/[\\u0195]/g},\n        {'base':'i', 'letters':/[\\u0069\\u24D8\\uFF49\\u00EC\\u00ED\\u00EE\\u0129\\u012B\\u012D\\u00EF\\u1E2F\\u1EC9\\u01D0\\u0209\\u020B\\u1ECB\\u012F\\u1E2D\\u0268\\u0131]/g},\n        {'base':'j', 'letters':/[\\u006A\\u24D9\\uFF4A\\u0135\\u01F0\\u0249]/g},\n        {'base':'k', 'letters':/[\\u006B\\u24DA\\uFF4B\\u1E31\\u01E9\\u1E33\\u0137\\u1E35\\u0199\\u2C6A\\uA741\\uA743\\uA745\\uA7A3]/g},\n        {'base':'l', 'letters':/[\\u006C\\u24DB\\uFF4C\\u0140\\u013A\\u013E\\u1E37\\u1E39\\u013C\\u1E3D\\u1E3B\\u017F\\u0142\\u019A\\u026B\\u2C61\\uA749\\uA781\\uA747]/g},\n        {'base':'lj','letters':/[\\u01C9]/g},\n        {'base':'m', 'letters':/[\\u006D\\u24DC\\uFF4D\\u1E3F\\u1E41\\u1E43\\u0271\\u026F]/g},\n        {'base':'n', 'letters':/[\\u006E\\u24DD\\uFF4E\\u01F9\\u0144\\u00F1\\u1E45\\u0148\\u1E47\\u0146\\u1E4B\\u1E49\\u019E\\u0272\\u0149\\uA791\\uA7A5]/g},\n        {'base':'nj','letters':/[\\u01CC]/g},\n        {'base':'o', 'letters':/[\\u006F\\u24DE\\uFF4F\\u00F2\\u00F3\\u00F4\\u1ED3\\u1ED1\\u1ED7\\u1ED5\\u00F5\\u1E4D\\u022D\\u1E4F\\u014D\\u1E51\\u1E53\\u014F\\u022F\\u0231\\u00F6\\u022B\\u1ECF\\u0151\\u01D2\\u020D\\u020F\\u01A1\\u1EDD\\u1EDB\\u1EE1\\u1EDF\\u1EE3\\u1ECD\\u1ED9\\u01EB\\u01ED\\u00F8\\u01FF\\u0254\\uA74B\\uA74D\\u0275]/g},\n        {'base':'oi','letters':/[\\u01A3]/g},\n        {'base':'ou','letters':/[\\u0223]/g},\n        {'base':'oo','letters':/[\\uA74F]/g},\n        {'base':'p','letters':/[\\u0070\\u24DF\\uFF50\\u1E55\\u1E57\\u01A5\\u1D7D\\uA751\\uA753\\uA755]/g},\n        {'base':'q','letters':/[\\u0071\\u24E0\\uFF51\\u024B\\uA757\\uA759]/g},\n        {'base':'r','letters':/[\\u0072\\u24E1\\uFF52\\u0155\\u1E59\\u0159\\u0211\\u0213\\u1E5B\\u1E5D\\u0157\\u1E5F\\u024D\\u027D\\uA75B\\uA7A7\\uA783]/g},\n        {'base':'s','letters':/[\\u0073\\u24E2\\uFF53\\u00DF\\u015B\\u1E65\\u015D\\u1E61\\u0161\\u1E67\\u1E63\\u1E69\\u0219\\u015F\\u023F\\uA7A9\\uA785\\u1E9B]/g},\n        {'base':'t','letters':/[\\u0074\\u24E3\\uFF54\\u1E6B\\u1E97\\u0165\\u1E6D\\u021B\\u0163\\u1E71\\u1E6F\\u0167\\u01AD\\u0288\\u2C66\\uA787]/g},\n        {'base':'tz','letters':/[\\uA729]/g},\n        {'base':'u','letters':/[\\u0075\\u24E4\\uFF55\\u00F9\\u00FA\\u00FB\\u0169\\u1E79\\u016B\\u1E7B\\u016D\\u00FC\\u01DC\\u01D8\\u01D6\\u01DA\\u1EE7\\u016F\\u0171\\u01D4\\u0215\\u0217\\u01B0\\u1EEB\\u1EE9\\u1EEF\\u1EED\\u1EF1\\u1EE5\\u1E73\\u0173\\u1E77\\u1E75\\u0289]/g},\n        {'base':'v','letters':/[\\u0076\\u24E5\\uFF56\\u1E7D\\u1E7F\\u028B\\uA75F\\u028C]/g},\n        {'base':'vy','letters':/[\\uA761]/g},\n        {'base':'w','letters':/[\\u0077\\u24E6\\uFF57\\u1E81\\u1E83\\u0175\\u1E87\\u1E85\\u1E98\\u1E89\\u2C73]/g},\n        {'base':'x','letters':/[\\u0078\\u24E7\\uFF58\\u1E8B\\u1E8D]/g},\n        {'base':'y','letters':/[\\u0079\\u24E8\\uFF59\\u1EF3\\u00FD\\u0177\\u1EF9\\u0233\\u1E8F\\u00FF\\u1EF7\\u1E99\\u1EF5\\u01B4\\u024F\\u1EFF]/g},\n        {'base':'z','letters':/[\\u007A\\u24E9\\uFF5A\\u017A\\u1E91\\u017C\\u017E\\u1E93\\u1E95\\u01B6\\u0225\\u0240\\u2C6C\\uA763]/g}\n      ];\n\n      for(var i=0; i<defaultDiacriticsRemovalMap.length; i++) {\n        str = str.replace(defaultDiacriticsRemovalMap[i].letters, defaultDiacriticsRemovalMap[i].base);\n      }\n\n      return str;\n\n    }\n\n    function replaceSpacesWithUnderscores(str) {\n      return str.replace(/\\ /g, '_');\n    }\n\n    function keepOnlyAlfanumericsDotsMonkeysUnderscoresAndDashes(str) {\n      return str.replace(/[^a-z0-9\\.@_\\-]/ig, '');\n    }\n\n    function unicodeToAscii(str) {\n      str = transliterateCyrillicToLatin(str);\n      str = replaceDiacritics(str);\n      return str;\n    }\n\n    function toSafeUriString(str) {\n      str = unicodeToAscii(str);\n      str = replaceSpacesWithUnderscores(str);\n      str = keepOnlyAlfanumericsDotsMonkeysUnderscoresAndDashes(str);\n      return str;\n    }\n\n\n    return {\n      toSafeUriString: toSafeUriString\n    }\n  }\n\n\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall.helpers')\n    .filter('filename', filename);\n\n  /** @ngInject */\n  function filename() {\n    return function (input, part) {\n      part = part || 'first';\n      input = input || '';\n      var out = \"\";\n\n      // TODO(stepanic): refactor with better\n\n      var urlParts = input.split('/');\n      var filenameParts = urlParts[urlParts.length - 1].split('-');\n\n      if (part === 'first') {\n        var displayName = filenameParts[0].replace(/_/g, ' ');\n        if (displayName.match(/^[a-zA-Z]/)) {\n          if (displayName.match(/@/)) {\n            out = displayName;\n          } else {\n            out = '@' + displayName;\n          }\n        }\n      } else {\n        out = input;\n      }\n\n      return out;\n    };\n  }\n\n})();\n\n\n\n\n(function() {\n  'use strict';\n\n  angular\n      .module('mediaWall')\n      .service('WallService', WallService);\n\n  /** @ngInject */\n  function WallService(ENV, $http, localStorageService) {\n\n    var serverBase = ENV.backendUrl;\n\n    function current () {\n      var wall = localStorageService.get('wall');\n      return wall;\n    }\n\n    function info (password, callback) {\n      var requestUrl = serverBase + '/wall/info';\n\n      var fd = new FormData();\n      fd.append('password', password);\n\n      $http.post(requestUrl, fd, {\n        transformRequest: angular.identity,\n        headers: {\n          'Content-Type': undefined\n        }\n      })\n      .success(function (response) {\n        if (!response || !response.data) {\n          return callback(null, {\n            code: 100404\n          });\n        }\n        var wall = response.data;\n        // save in local storage\n        localStorageService.set('wall', wall);\n        // return data as callback\n        callback(wall);\n      })\n      .error(function (response) {\n        callback(null, {\n          code: 100404\n        });\n      });\n    }\n\n    function auth (id, password, pin, callback) {\n      var requestUrl = serverBase + '/wall/auth';\n\n      var fd = new FormData();\n      fd.append('id', id);\n      fd.append('password', password);\n      fd.append('pin', pin);\n\n      $http.post(requestUrl, fd, {\n        transformRequest: angular.identity,\n        headers: {\n          'Content-Type': undefined\n        }\n      })\n      .success(function (response) {\n        if (!response || !response.data) {\n          return callback(null, {\n            code: 100404\n          });\n        }\n        var wall = response.data;\n        // save in local storage\n        localStorageService.set('wall', wall);\n        // return data as callback\n        callback(wall);\n      })\n      .error(function (response) {\n        callback(null, {\n          code: 100404\n        });\n      });\n    }\n\n    function approveFileApi (file, password, masterKey, callback, disapprove) {\n      var requestUrl = serverBase + '/wall/approve/file';\n\n      var params = {\n        file: file,\n        password: password,\n        masterKey: masterKey\n      };\n\n      if (disapprove) {\n        params.disapprove = true;\n      }\n\n      $http.post(requestUrl, params)\n      .success(function (response) {\n        callback(response.data);\n      })\n      .error(function (response, status) {\n        callback(null, {\n          status: status,\n          summary: response.summary\n        });\n      });\n    }\n\n    function approveFile (file, password, masterKey, callback) {\n      approveFileApi(file, password, masterKey, callback);\n    }\n\n    function disapproveFile (file, password, masterKey, callback) {\n      approveFileApi(file, password, masterKey, callback, true);\n    }\n\n    return {\n      current: current,\n      info: info,\n      auth: auth,\n      approveFile: approveFile,\n      disapproveFile: disapproveFile\n    }\n  }\n\n\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n      .module('mediaWall')\n      .service('UploadService', UploadService);\n\n  /** @ngInject */\n  function UploadService(ENV, $http, localStorageService, $log, stringHelpers) {\n\n    var serverBase = ENV.backendUrl;\n\n    function getFilePrefix() {\n      var prefix = '';\n\n      var currentEmail = localStorageService.get('currentEmail');\n      var currentDisplayName = localStorageService.get('currentDisplayName');\n\n      if (currentDisplayName && !currentDisplayName.startsWith('.')) {\n        prefix += currentDisplayName + \"-\";\n      }\n\n      if (currentEmail && !currentEmail.startsWith('.')) {\n        prefix += currentEmail + \"-\";\n      }\n\n      return stringHelpers.toSafeUriString(prefix);\n    }\n\n    function uploadFiles(files, callback, uploadProgress, wallMasterKey) {\n      var uploadUrl = serverBase + '/upload';\n\n      var fd = new FormData();\n\n      var wall = localStorageService.get('wall');\n      fd.append('wall-id', wall.id);\n      fd.append('wall-password', wall.password);\n      fd.append('wall-pin', wall.pin);\n      if (wallMasterKey) {\n        fd.append('wall-master-key', wallMasterKey);\n      }\n      fd.append('prefix', getFilePrefix());\n\n      for (var i = 0; i < files.length; i++) {\n        fd.append('files', files[i]);\n      }\n\n      $log.info('Upload started');\n\n      var xhr = new XMLHttpRequest();\n\n      xhr.upload.addEventListener(\"progress\", uploadProgress, false);\n\n      xhr.addEventListener(\"readystatechange\", function (e) {\n        // upload completed\n        if (this.readyState === 4) {\n          $log.info('Success: Upload done', e);\n\n          var response = e.target.response;\n\n          if (response) {\n            try {\n              response=JSON.parse(response);\n            } catch (e) {\n              $log.error('JSON.parse()', e);\n            }\n          }\n\n          callback(false, response);\n        }\n\n        // xhr = null;\n      });\n\n      xhr.addEventListener(\"error\", function (e) {\n        $log.error('Error: Upload failed', e);\n        callback(true);\n      });\n      //xhr.addEventListener(\"abort\", uploadCanceled, false);\n      xhr.open(\"POST\", uploadUrl);\n\n      // send the form data to the server\n      xhr.send(fd);\n\n    }\n\n    return {\n      files: uploadFiles\n    }\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .run(runBlock);\n\n  /** @ngInject */\n  function runBlock($log, $rootScope, $window) {\n\n    // TODO(stepanic): try to refactor with better Angular way maybe with $state\n    // slideshow is required to make overflow: hidden on <body> tag\n    if ($window.location.pathname === '/gledaj' || $window.location.pathname === '/gledaj/provjereno') {\n      $rootScope.slideshow = 'true';\n    } else {\n      $rootScope.slideshow = 'false';\n    }\n\n    $log.debug('runBlock end');\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .config(routerConfig);\n\n  /** @ngInject */\n  function routerConfig($stateProvider, $urlRouterProvider) {\n    $stateProvider\n      .state('home', {\n        url: '/',\n        templateUrl: 'app/home/home.html',\n        controller: 'HomeController',\n        controllerAs: 'home'\n      })\n      .state('info', {\n        url: '/info',\n        templateUrl: 'app/info/info.html',\n        controller: 'InfoController',\n        controllerAs: 'info'\n      })\n      .state('profile', {\n        url: '/profil',\n        templateUrl: 'app/profile/profile.html',\n        controller: 'ProfileController',\n        controllerAs: 'profile'\n      })\n      .state('record', {\n        url: '/fotkaj',\n        templateUrl: 'app/record/record.html',\n        controller: 'RecordController',\n        controllerAs: 'record'\n      })\n      .state('recordWithMasterKey', {\n        url: '/fotkaj/:masterKey',\n        templateUrl: 'app/record/record.html',\n        controller: 'RecordController',\n        controllerAs: 'record'\n      })\n      .state('gallery', {\n        url: '/pregledaj',\n        templateUrl: 'app/wall/wall.html',\n        controller: 'WallController',\n        controllerAs: 'wall'\n      })\n      .state('wallVerify', {\n        url: '/gledaj/provjeri',\n        templateUrl: 'app/wall/wall.html',\n        controller: 'WallController',\n        controllerAs: 'wall'\n      })\n      .state('wallVerifyRemote', {\n        url: '/gledaj/provjeri/:password/:masterKey',\n        templateUrl: 'app/wall/wall.html',\n        controller: 'WallController',\n        controllerAs: 'wall'\n      })\n      .state('wallVerified', {\n        url: '/gledaj/provjereno',\n        templateUrl: 'app/wall/wall.html',\n        controller: 'WallVerifiedController',\n        controllerAs: 'wall'\n      })\n      .state('wallVerifiedDirect', {\n        url: '/gledaj/provjereno/:wallPassword',\n        templateUrl: 'app/wall/wall.html',\n        controller: 'WallVerifiedController',\n        controllerAs: 'wall'\n      })\n      .state('wall', {\n        url: '/gledaj',\n        templateUrl: 'app/wall/wall.html',\n        controller: 'WallController',\n        controllerAs: 'wall'\n      })\n        .state('wallDirect', {\n          url: '/gledaj/:wallPassword',\n          templateUrl: 'app/wall/wall.html',\n          controller: 'WallController',\n          controllerAs: 'wall'\n        })\n      .state('directOpenWallFromUrlParam', {\n        url: '/:wallPassword',\n        templateUrl: 'app/home/home.html',\n        controller: 'HomeController',\n        controllerAs: 'home'\n      });\n\n    $urlRouterProvider.otherwise('/');\n  }\n\n})();\n\n/* global, moment:false */\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .constant('publicName', 'Vjenčanje.online');\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('mediaWall')\n    .config(function ($sailsProvider, ENV) {\n      $sailsProvider.url = ENV.backendUrl;\n    })\n    .config(function (logExProvider, ENV) {\n      logExProvider.enableLogging(ENV.enableLogging);\n    })\n    .config(config);\n\n  /** @ngInject */\n  function config($logProvider, $locationProvider, localStorageServiceProvider, cfpLoadingBarProvider) {\n    // Enable log\n    $logProvider.debugEnabled(true);\n\n    // HTML5 mode\n    $locationProvider.html5Mode(true).hashPrefix('!');\n\n    // Local Storage\n    localStorageServiceProvider\n      .setPrefix('mediaWall');\n\n    cfpLoadingBarProvider.autoIncrement = false;\n  }\n\n})();\n\nangular.module(\"mediaWall\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/home/home.html\",\"<div layout=\\\"row\\\" layout-fill=\\\"\\\" layout-align=\\\"center center\\\" id=\\\"home-simple\\\" device-detector=\\\"\\\"><h1><strong onclick=\\\"document.getElementById(\\'input-password\\').focus()\\\">Vjenčanje</strong>.online</h1><h2>Nemojte propustiti niti jedan trenutak!</h2><form ng-submit=\\\"home.GoToRecord()\\\"><div layout=\\\"column\\\" layout-align=\\\"center\\\" ng-cloak=\\\"\\\" class=\\\"md-inline-form\\\"><p ng-show=\\\"home.wrongPassword\\\" class=\\\"error\\\">Neispravna lozinka, pokušajte ponovno!</p><p ng-show=\\\"home.wrongPin\\\" class=\\\"error\\\">Neispravan PIN, pokušajte ponovno!</p><md-input-container><label>Lozinka</label> <input type=\\\"text\\\" id=\\\"input-password\\\" focus-me=\\\"home.passwordIsFocused\\\" ng-model=\\\"home.password\\\"></md-input-container><md-input-container ng-show=\\\"home.wall.hasPin\\\"><label>Pin</label> <input type=\\\"number\\\" id=\\\"input-pin-simple\\\" focus-me=\\\"home.pinIsFocused\\\" pattern=\\\"[0-9]*\\\" onkeyup=\\\"document.getElementById(\\'input-pin-simple\\').value = document.getElementById(\\'input-pin-simple\\').value.slice(0,4); angular.element(this).scope().SetValidPin(document.getElementById(\\'input-pin-simple\\').value)\\\" onkeydown=\\\"if (event.keyCode === 13) { return false; }\\\"></md-input-container><md-button class=\\\"md-raised\\\"><strong>Ulazak na vjenčanje</strong></md-button></div></form></div><div layout=\\\"row\\\" layout-fill=\\\"\\\" layout-align=\\\"center center\\\" id=\\\"home\\\" device-detector=\\\"\\\"><div layout=\\\"column\\\" class=\\\"container\\\"><div layout-align=\\\"center center\\\" class=\\\"title\\\" flex=\\\"\\\"><h1 class=\\\"md-display-3 logo\\\"><span onclick=\\\"document.getElementById(\\'input-password\\').focus()\\\"><img src=\\\"assets/images/logo.png\\\"></span></h1><h2 class=\\\"md-display-1\\\">Nemojte propustiti niti jedan trenutak!</h2><p class=\\\"process-image\\\" hide-md=\\\"\\\" hide-sm=\\\"\\\" hide-xs=\\\"\\\"><img src=\\\"assets/images/process.png\\\"></p><form ng-submit=\\\"home.GoToRecord()\\\"><div layout=\\\"column\\\" layout-align=\\\"center\\\" ng-cloak=\\\"\\\" class=\\\"md-inline-form\\\"><p ng-show=\\\"home.wrongPassword\\\" class=\\\"error\\\">Neispravna lozinka, pokušajte ponovno!</p><p ng-show=\\\"home.wrongPin\\\" class=\\\"error\\\">Neispravan PIN, pokušajte ponovno!</p><md-input-container flex=\\\"\\\"><label>Lozinka</label> <input type=\\\"text\\\" id=\\\"input-password\\\" focus-me=\\\"home.passwordIsFocused\\\" ng-model=\\\"home.password\\\"></md-input-container><md-input-container ng-show=\\\"home.wall.hasPin\\\" flex=\\\"\\\"><label>Pin</label> <input type=\\\"number\\\" id=\\\"input-pin\\\" focus-me=\\\"home.pinIsFocused\\\" pattern=\\\"[0-9]*\\\" onkeyup=\\\"document.getElementById(\\'input-pin\\').value = document.getElementById(\\'input-pin\\').value.slice(0,4); angular.element(this).scope().SetValidPin(document.getElementById(\\'input-pin\\').value)\\\" onkeydown=\\\"if (event.keyCode === 13) { return false; }\\\"></md-input-container><md-button class=\\\"md-raised\\\"><strong>Ulazak na vjenčanje</strong></md-button></div></form></div></div></div>\");\n$templateCache.put(\"app/info/info.html\",\"INFO\");\n$templateCache.put(\"app/profile/profile.html\",\"<div layout=\\\"column\\\" layout-fill=\\\"\\\" layout-align=\\\"center center\\\" id=\\\"profile\\\"><div layout=\\\"column\\\" class=\\\"container\\\"><div layout-align=\\\"center\\\" flex=\\\"\\\"><h1 class=\\\"logo\\\"><span onclick=\\\"document.getElementById(\\'input-email\\').focus()\\\"><img src=\\\"assets/images/logo.png\\\"></span></h1><form class=\\\"profile-form\\\" ng-submit=\\\"profile.saveProfileAndReturnToRecord()\\\"><div layout=\\\"column\\\" layout-align=\\\"center\\\" ng-cloak=\\\"\\\" class=\\\"md-inline-form\\\"><div class=\\\"fields\\\"><p ng-show=\\\"profile.invalidEmail\\\" class=\\\"error\\\">Neispravna email adresa, pokušajte ponovno!</p><p ng-show=\\\"profile.invalidName\\\" class=\\\"error\\\">Neispravno ime i prezime, pokušajte ponovno!</p><md-input-container ng-show=\\\"false\\\" flex=\\\"\\\"><label>Email adresa</label> <input type=\\\"text\\\" id=\\\"input-email\\\" focus-me=\\\"profile.emailIsFocused\\\" ng-model=\\\"profile.email\\\"></md-input-container><div ng-show=\\\"false\\\" class=\\\"helper-note\\\">* Ukoliko želite primati obavijesti kako fotke i video zapisi stižu, molim Vas upišite svoju email adresu.</div><md-input-container flex=\\\"\\\"><label>Ime i prezime</label> <input type=\\\"text\\\" id=\\\"input-display-name\\\" ng-model=\\\"profile.displayName\\\" focus-me=\\\"profile.nameIsFocused\\\"></md-input-container><div class=\\\"helper-note\\\">* Super je znati tko je poslao fotku ili video zapis pa Vas molimo da upišete svoje ime i prezime.</div></div><md-button class=\\\"md-raised\\\"><strong>Spremi i fotkaj</strong></md-button></div></form></div></div></div>\");\n$templateCache.put(\"app/record/record.html\",\"<div layout=\\\"column\\\" layout-fill=\\\"\\\" layout-align=\\\"center center\\\" id=\\\"record\\\"><div class=\\\"progress-counter\\\" ng-show=\\\"showProgressBar\\\">{{progressCounter | number:0}}%</div><div class=\\\"wall-description-mobile\\\"><div class=\\\"close\\\" ng-click=\\\"record.GoToHomepage()\\\">&nbsp;</div><div class=\\\"cname\\\">{{wall.password}}</div><div class=\\\"info\\\"><button ng-click=\\\"record.EditProfile()\\\">&nbsp;</button></div><div class=\\\"watch\\\"><button ng-click=\\\"record.GoToWall()\\\">&nbsp;</button></div><div class=\\\"gallery\\\"><button ng-click=\\\"record.GoToGallery()\\\">&nbsp;</button></div></div><div hide-gt-md=\\\"\\\" class=\\\"logo-out-container\\\"><img src=\\\"assets/images/logo.png\\\"></div><div hide-gt-md=\\\"\\\" class=\\\"upload-as-file\\\" device-detector=\\\"\\\"><button onclick=\\\"document.getElementById(\\'input-as-file\\').click()\\\">&nbsp;</button> <input type=\\\"file\\\" accept=\\\"video/*,image/*\\\" id=\\\"input-as-file\\\" multiple=\\\"\\\" name=\\\"files\\\" ng-disabled=\\\"progressCounter > 0\\\" onchange=\\\"angular.element(this).scope().HandleFiles(this.files)\\\"></div><h1 class=\\\"md-display-2 app-title\\\" hide-sm=\\\"\\\" hide-md=\\\"\\\"><div><img src=\\\"assets/images/logo.png\\\" style=\\\"max-height: 100px\\\"></div><div class=\\\"app-subtitle\\\">Pošaljite mladencima <strong>jedinstvene trenutke</strong> koje ste vi zabilježli :)</div></h1><div layout=\\\"row\\\" layout-sm=\\\"column\\\" layout-md=\\\"column\\\" layout-fill=\\\"\\\" layout-align=\\\"space-around center\\\" layout-align-sm=\\\"start center\\\"><div hide-sm=\\\"\\\" hide-gt-md=\\\"\\\" class=\\\"logo-container\\\"><img src=\\\"assets/images/logo.png\\\"></div><div><h1 class=\\\"md-display-3\\\" hide-sm=\\\"\\\" hide-md=\\\"\\\"><span style=\\\"font-size: 36px;\\\">Pošaljite<br></span>Foto</h1><md-button class=\\\"md-fab\\\" aria-label=\\\"Fotoaparat\\\" onclick=\\\"document.getElementById(\\'input-photo\\').click()\\\"><md-icon md-svg-src=\\\"assets/svg/camera.svg\\\"></md-icon></md-button><input type=\\\"file\\\" accept=\\\"image/*\\\" id=\\\"input-photo\\\" capture=\\\"camera\\\" multiple=\\\"\\\" name=\\\"files\\\" ng-disabled=\\\"progressCounter > 0\\\" onchange=\\\"angular.element(this).scope().HandleFiles(this.files)\\\"></div><div hide-sm=\\\"\\\" hide-md=\\\"\\\" layout=\\\"row\\\"><h1 class=\\\"md-display-2\\\" style=\\\"margin: 20px; margin-right: 10px\\\">Gledajte <strong>LIVE</strong><br><md-button class=\\\"md-fab\\\" aria-label=\\\"Projektor\\\" ng-click=\\\"record.GoToWall()\\\"><md-icon md-svg-src=\\\"assets/svg/cinema.svg\\\"></md-icon></md-button></h1><h1 class=\\\"md-display-2\\\" style=\\\"margin: 20px; margin-left: 10px\\\">Otvorite <strong>GALERIJU</strong><br><md-button class=\\\"md-fab\\\" aria-label=\\\"Galerija\\\" ng-click=\\\"record.GoToGallery()\\\"><md-icon md-svg-src=\\\"assets/svg/gallery.svg\\\"></md-icon></md-button></h1></div><div><h1 class=\\\"md-display-3\\\" hide-sm=\\\"\\\" hide-md=\\\"\\\"><span style=\\\"font-size: 36px;\\\">Pošaljite<br></span>Video</h1><md-button class=\\\"md-fab\\\" hide-sm=\\\"\\\" hide-md=\\\"\\\" aria-label=\\\"Kamera\\\" onclick=\\\"document.getElementById(\\'input-video-multiple\\').click()\\\"><md-icon md-svg-src=\\\"assets/svg/camcorder.svg\\\"></md-icon></md-button><input type=\\\"file\\\" accept=\\\"video/*\\\" id=\\\"input-video-multiple\\\" capture=\\\"camcorder\\\" multiple=\\\"\\\" ng-disabled=\\\"progressCounter > 0\\\" name=\\\"files\\\" onchange=\\\"angular.element(this).scope().HandleFiles(this.files)\\\"><md-button class=\\\"md-fab\\\" hide-gt-md=\\\"\\\" aria-label=\\\"Kamera\\\" onclick=\\\"document.getElementById(\\'input-video\\').click()\\\"><md-icon md-svg-src=\\\"assets/svg/camcorder.svg\\\"></md-icon></md-button><input type=\\\"file\\\" accept=\\\"video/*\\\" id=\\\"input-video\\\" capture=\\\"camcorder\\\" name=\\\"files\\\" ng-disabled=\\\"progressCounter > 0\\\" onchange=\\\"angular.element(this).scope().HandleFiles(this.files)\\\"></div></div></div>\");\n$templateCache.put(\"app/wall/wall.html\",\"<div layout=\\\"column\\\" layout-fill=\\\"\\\" layout-align=\\\"space-around center\\\" layout-align-sm=\\\"start center\\\"><div id=\\\"wall\\\" ng-class=\\\"{ \\'slideshow\\': wall.slideshow, \\'verified\\': wall.wallMode === \\'verified\\', \\'watch\\': wall.wallMode === \\'watch\\' }\\\" flex=\\\"\\\"><div ng-if=\\\"!wall.files.length\\\" class=\\\"no-media-info\\\" style=\\\"height: {{windowInnerHeight}}px\\\" unselectable=\\\"on\\\"><img ng-if=\\\"wall.splash\\\" ng-src=\\\"{{wall.splash.url}}\\\"> <img ng-if=\\\"!wall.splash\\\" src=\\\"assets/images/splash.png\\\" style=\\\"max-height: {{windowInnerHeight * 0.7}}px; max-width: 100%; margin-top: {{windowInnerHeight * 0.15}}px\\\"></div><ul ng-show=\\\"wall.files.length\\\"><li ng-repeat=\\\"(key, file) in wall.files\\\" id=\\\"media-{{key}}\\\" ng-mousedown=\\\"wall.handleFile(file, $event)\\\" ng-class=\\\"{ \\'visible-animation\\': wall.flags.enableMainFileAnimation }\\\"><md-button ng-show=\\\"wall.isVerifyPage === true && key === 0\\\" class=\\\"md-fab verify\\\" ng-click=\\\"wall.verifyFile(file)\\\">&#10003;</md-button><md-button ng-show=\\\"wall.isVerifyPage === true && key === 0\\\" class=\\\"md-fab unverify\\\" ng-click=\\\"wall.unverifyFile(file)\\\">&#10007;</md-button><video class=\\\"box\\\" style=\\\"height: {{windowInnerHeight}}px\\\" ng-muted=\\\"{{key > 0}}\\\" ng-controls=\\\"{{!!file.controls}}\\\" autoplay=\\\"\\\" ng-show=\\\"key === 0 && file.type.startsWith(\\'video\\')\\\" ng-click=\\\"console.log(this)\\\"><source ng-src=\\\"{{file.trustedUrl}}\\\" type=\\\"video/mp4\\\"></video><div class=\\\"box\\\" style=\\\"height: 15vw\\\" ng-show=\\\"key > 0 && file.type.startsWith(\\'video\\')\\\"><video class=\\\"mosaic\\\" ng-muted=\\\"{{key > 0}}\\\" ng-controls=\\\"{{!!file.controls}}\\\" autoplay=\\\"\\\"><source ng-src=\\\"{{file.trustedUrl}}\\\" type=\\\"video/mp4\\\"></video></div><div class=\\\"box o{{file.orientation}}\\\" ng-dblclick=\\\"wall.removeFile(file)\\\" ng-show=\\\"key === 0 && file.type.startsWith(\\'image\\')\\\" style=\\\"height: {{windowInnerHeight}}px; width: {{firstImageWidth}}px; background-image: url(\\'{{file.url}}\\')\\\"></div><div class=\\\"box o{{file.orientation}} mosaic\\\" ng-show=\\\"key > 0 && file.type.startsWith(\\'image\\')\\\" style=\\\"height: {{(windowInnerWidth / 10) * 1.5}}px; background-image: url(\\'{{file.url}}\\')\\\"></div><div class=\\\"author\\\">{{file.url | filename}} {{file.removed | json}}</div></li></ul><div class=\\\"powered-by\\\" ng-show=\\\"wall.files.length\\\"><img src=\\\"assets/images/powered-by.png\\\" style=\\\"height: {{windowInnerHeight * 0.05}}px\\\"></div><div class=\\\"main-title\\\" ng-show=\\\"wall.files.length\\\"><img ng-if=\\\"wall.image\\\" ng-src=\\\"{{wall.image.url}}\\\"> <img ng-if=\\\"!wall.image\\\" src=\\\"assets/images/wall-image.png\\\"></div><div class=\\\"options\\\" ng-class=\\\"{ \\'is-visible-options\\' : isVisibleOptions }\\\" ng-mouseover=\\\"isVisibleOptions = true\\\" ng-mouseleave=\\\"isVisibleOptions = false\\\"><md-button class=\\\"md-fab\\\" aria-label=\\\"Projektor\\\" ng-click=\\\"wall.ToggleWallMode()\\\"><md-icon md-svg-src=\\\"assets/svg/cinema.svg\\\"></md-icon></md-button><md-button class=\\\"md-fab\\\" aria-label=\\\"Fotoaparat\\\" ng-click=\\\"wall.GoToRecord()\\\"><md-icon md-svg-src=\\\"assets/svg/camera.svg\\\"></md-icon></md-button><md-button class=\\\"md-fab\\\" aria-label=\\\"Fotoaparat\\\" ng-click=\\\"wall.GoToWallVerify()\\\" ng-if=\\\"wall.isVisibleWallVerifyOption\\\">ADMIN</md-button></div></div></div>\");}]);"],"sourceRoot":"/source/"}